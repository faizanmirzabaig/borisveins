(function(u){"use strict";u(document).ready(function(){u(".es_subscription_form").each(function(){if(u(this).is(":hidden")){u(this).on("submit",function(e){e.preventDefault();var s=u(this);r(s)})}})});function n(e,r){var i=[];var n=false;jQuery.each(e.serializeArray()||{},function(e,s){if(s.name==="esfpx_lists[]"){i.push(s.value);n=true}else{r[s.name]=s.value}});if(n){r["esfpx_lists[]"]=i}return r}function t(e,s){var r=e.status;var i="success";if(r==="ERROR"){i="error"}var n=e["message_text"];var t=u(s).next(".es_subscription_message");t.attr("class","es_subscription_message "+i);t.html(n);var a={detail:{es_response:i,msg:n},bubbles:true,cancelable:true};jQuery(s).trigger("es_response",[a])}function r(s,r){var r=r||false;var e={};e=n(s,e);e["es"]="subscribe";e["action"]="es_add_subscriber";var i=es_data.es_ajax_url;jQuery(s).find("#spinner-image").show();u.ajax({type:"POST",url:i,data:e,dataType:"json",success:function(e){if(!r){if(e&&typeof e.status!=="undefined"&&e.status==="SUCCESS"){jQuery(s).slideUp("slow");jQuery(s).hide()}else{jQuery(s).find("#spinner-image").hide()}}jQuery(window).trigger("es.send_response",[jQuery(s),e]);t(e,s)},error:function(e){jQuery(s).find("#spinner-image").hide();console.log(e,"error")}});return false}jQuery(window).on("init.icegram",function(e,s){if(typeof s!=="undefined"&&typeof s.messages!=="undefined"){jQuery('.icegram .es_shortcode_form, .icegram form[data-source="ig-es"]').each(function(e,s){jQuery(s).bind("submit",function(e){e.preventDefault();var s=u(this);r(s,true)})})}})})(jQuery);